#!/usr/bin/env ruby -w

$: << "lib" << "."

ENABLE_LOG = true

require 'struggle'
require 'struggle/game'

g = Game.new
g.start

g.accept(
  Move.new(
    player: USSR,
    instruction: Instructions::AddInfluence.new(
      influence: USSR,
      country_name: "East Germany",
      amount: 6
    )
  )
)

g.accept(
  Move.new(
    player: US,
    instruction: Instructions::AddInfluence.new(
      influence: US,
      country_name: "Italy",
      amount: 7
    )
  )
)

# skip headline for now...

# Pick an opponent card for USSR to play.
card = g.hand(USSR).detect { |c| c.side == US }

puts "USSR Playing #{card.inspect}"

# play opponent card, first for event...
g.accept(
  Move.new(
    player: USSR,
    instruction: Instructions::PlayCard.new(
      player: USSR,
      card_ref: card.ref,
      card_action: :event,
    )
  )
)

# ...and then for influence
g.accept(
  Move.new(
    player: USSR,
    instruction: Instructions::PlayCard.new(
      player: USSR,
      card_ref: card.ref,
      card_action: :influence,
    )
  )
)

# add influence here

g.accept(
  Move.new(
    player: USSR,
    instruction: Instructions::AddInfluence.new(
      influence: USSR,
      country_name: "Romania",
      amount: card.ops!
    )
  )
)

## US AR

# US picks own card to play
card = g.hand(US).detect { |c| c.side == US }

puts "US   Playing #{card.inspect}"

# play own card for coup
g.accept(
  Move.new(
    player: US,
    instruction: Instructions::PlayCard.new(
      player: US,
      card_ref: card.ref,
      card_action: :coup,
    )
  )
)

g.accept(
  Move.new(
    player: US,
    instruction: Instructions::Coup.new(
      player: US,
      country_name: "Romania"
    )
  )
)



puts "HINT: ===="
p g.hint

exit
pp g

